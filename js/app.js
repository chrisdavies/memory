var mem={};!function(){var e,n={};mem.page=function(e,t){n[e]=t},mem.showPage=function(t,i){var o=n[t];if(!o)throw{err:'Page "'+t+'" not found.'};e&&e.destroy&&e.destroy(),e=o(i),mem.render(e.view||t+"Template",e.data||{}),e.init&&e.init()}}(),mem.format={padLeft:function(e,n,t){return e.length>=n?e:Array(1+n-e.length).join(t||"0")+e},time:function(e){function n(e){return mem.format.padLeft(Math.floor(e).toString(),2)}var t=e/1e3,i=t/60,o=i/60;return Math.floor(o)+":"+n(i%60)+":"+n(t%60)}},function(){function e(e){return e.map(function(e){return{value:e,flipped:!1}})}function n(n){function t(){return d.every(function(e){return e.flipped})}function i(){return 0>=g}function o(){t()&&$(v).trigger("won")}function r(){i()&&$(v).trigger("lost")}function u(){$(v).trigger("match")}function a(e){--g,$(v).trigger("mismatch"),e.flipped=s.flipped=!1}function m(e){s=e}function c(e){s.value===e.value?(u(e),o()):(a(e),r()),s=void 0}function f(e){s?c(e):m(e)}function l(e){var n=d[e];return n.flipped||(n.flipped=!0,f(n)),n}var s,d=e(n.tiles),g=n.lives||Math.ceil(d.length/1.75),p=g,h=new Date,v={};return v.time=function(){return new Date-h},v.errors=function(){return p-g},v.lives=function(){return g},v.tiles=function(){return d},v.flipTile=l,v}mem.Game=n}(),mem.gameStats=function(e){var n={lives:e.lives(),errors:e.errors(),time:e.time()},t=1+n.lives/(n.errors+1),i=5e4/(n.time+1);return n.score=Math.ceil(2e3*t+2e3*i),n},function(){function e(e){var t=n.slice(0,e);return _.shuffle(t.concat(t))}var n="abcdefghijklmnop".split("");mem.generator={easy:function(){return e(9)},hard:function(){return e(16)}}}(),mem.views={},mem.render=function(e,n){$("main").replaceWith(mem.views[e](n))},function(){$('script[type="text/html"]').each(function(){mem.views[$(this).attr("id")]=_.template($(this).html(),null,{variable:"data"})})}(),mem.page("game",function(e){function n(){$("#game-details").html(mem.views.detailsTemplate(m))}function t(){$(m).on("mismatch",function(){var e=$(".game-tile input:not([disabled]):checked").get();setTimeout(function(){$(e).attr("checked",!1)},1e3)}),$(m).on("match",function(){$(".game-tile input:checked").attr("disabled",!0)}),$(m).on("won",function(){mem.showPage("win",mem.gameStats(m))}),$(m).on("lost",function(){mem.showPage("lose")})}function i(){$("main").on("click",".game-tile input",function(){var e=$(this).is(":checked");return m.flipTile($(this).closest(".game-tile").index()),e})}function o(){!function e(){n(),m&&(a=window.setTimeout(e,250))}()}function r(){t(),i(),o()}function u(){$(m).off(),m=void 0,window.clearTimeout(a)}var a,m=new mem.Game({tiles:mem.generator[e.difficulty]()});return{data:{game:m,difficulty:e.difficulty},init:r,destroy:u}}),mem.page("index",function(){function e(e){$("main").on("click",".menu-option."+e+"-game",function(n){return mem.showPage("game",{difficulty:e}),n.stopImmediatePropagation(),!1})}return{init:function(){e("easy"),e("hard")}}}),$(function(){mem.showPage("index")}),function(){function e(e){return{data:e,init:function(){$("main").on("click",".index-link",function(){return mem.showPage("index"),!1})}}}mem.page("win",e),mem.page("lose",e)}();
//# sourceMappingURL=app.js.map